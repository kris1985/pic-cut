# 数据库交互概述

## 1.概述​

### 1.1应用场景​

数据库交互在不同系统之间可以发挥重要的作用，使得数据可以在系统之间进行共享、同步和整合；

企业内部可能有多个不同的应用系统，每个系统可能都有自己的数据库。为了实现数据的共享和整合，需要进行数据库交互；

工业场景中的传感器和设备可能会产生大量的数据，这些数据需要收集、存储和处理。数据库交互可以用于将传感器数据存储到数据库中，并允许其他应用程序或系统访问和分析这些数据；

数据库交互为不同系统之间提供了一种高效、安全和可靠的数据交流方式，为数据驱动的应用和服务提供了基础。

### 1.2功能介绍​

#### **整体说明：**​

  1. 连接数据库： 首先，应用程序需要建立与数据库的连接，以便与数据库进行通信。连接数据库时，通常需要提供数据库服务器的地址、用户名、密码和数据库名称等信息。
  2. 发送数据库查询： 一旦与数据库建立连接，CMS可以通过配置的动作和触发的事件与数据库进行交互。查询可以是用于获取数据的动作，可以将查询的数据写入CMS的变量。插入是可以用来往数据库写入新数据的动作，可以将CMS变量中的数据插入到数据库中。修改可以是修改数据库中的数据，可以将变量中的数据用于修改数据库中已有的数据。
  3. 执行数据库动作： 数据库接收到应用程序发送的动作后，会执行相应的操作。对于查询语句，数据库会返回查询结果集。对于插入、更新动作，数据库会执行相应的数据操作并返回执行结果。
  4. 处理查询结果： 应用程序收到数据库返回的查询结果后，需要对结果进行处理。对于查询，可能需要写入变量并展示给用户或用于后续的数据处理。对于插入和修改的工作，通常会检查执行结果以确保操作成功。



#### 工作区布局：​

#### 1）配置界面：用户配置与外部数据库的交互逻辑​

**动作：** 下拉框提供查询、修改、插入的选项，满足用户对数据库操作的多个需求；

1.查询：根据配置查询数据库获取查询的第一条数据，将字段数据映射到对应的变量，完成将数据从数据库中查询出来的动作； 2.修改：根据配置的筛选条件，筛选数据表中所有匹配的数据，将当前变量的数值写入到映射的字段，完成对数据库数据的修改； 3.插入：将变量当前数值插入到当前的数据库，完成插入的动作；

**触发设置：** 可以根据现场的需求设置互联动作发生的时间，具体的触发事件，例如定时触发、变量触发等；（点击查看[触发配置](/cms/tutorial/数据管理/触发配置)）

**筛选：** 筛选条件，根据配置的筛选内容筛选出用户需要的字段；

1.字段：下拉框获取当前数据表中的所有字段；

2.条件：下拉框提供等于、不等于、不为空选项；

3.文本框：可手动输入具体数值或选择动态变量；

4.可根据实际需要配置多个筛选条件，多个筛选条件中可选择并且和或者的关系；

**排序：** 排序，根据配置的关键列排序条件对筛选的数据进行排序查看；

1.字段：下拉框获取当前数据表中的所有字段；

2.顺序：下拉框提供升序和降序两个选项；

**映射关系：** 选择数据库中的字段与CMS中的变量进行映射关联，实现数据的交互；

首先选择需要的字段，然后选择需要映射的变量；

#### 2）调试界面：根据配置界面配置的内容进行调试，查看对应的动作及数据是否为用户所要的内容；​

**数据库：** 根据配置的筛选条件及关键列排序条件，点击刷新按钮进行数据查看，确认当前数据是否是用户需要的数据；

**测试信息：** 点击测试按钮进行数据库的交互，返回数据库的执行结果，该窗口展示测试的结果，用户可根据该窗口查看配置是否正确；

**变量数值：** 实时查看关联的变量的实时值，对比字段数据与变量数据是否一致，判断执行的动作是否执行成功；


---

该文档地址来源：https://cms-docs.shengyc.com/cms/tutorial/%E9%9B%86%E6%88%90%E4%BA%92%E8%81%94/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%A4%E4%BA%92/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%A4%E4%BA%92%E6%A6%82%E8%BF%B0