# 变量概述

## 场景说明​

变量管理在CMS中扮演着重要角色，它用于管理和处理不同类型的变量，这些变量代表着工业过程中的实时数据、状态信息和控制指令。以下是一些变量管理在CMS中的常见应用场景：

  1. **过程监控与数据采集** ：CMS通过采集和管理传感器、仪表等设备的变量数据，实时监控工业过程的状态。例如，温度、压力、流量等变量的监测，有助于及时发现异常情况并采取必要的措施。
  2. **报警与事件处理** ：CMS对各种变量进行预设阈值设置，一旦变量超出设定的范围，就会触发报警和事件处理机制。例如，某个变量的数值超过安全范围，系统可以自动发出警报并通知相关人员。
  3. **数据存储与历史记录** ：CMS会将采集到的变量数据进行存储，以便后续分析和回放。历史记录可以用于故障排查、性能分析以及合规性报告。
  4. **远程控制与操作** ：通过CMS，操作员可以远程控制工业过程中的设备和系统。变量管理允许用户设置和修改控制指令，并将这些指令传递给相应的设备。
  5. **用户界面与可视化** ：变量管理在用户界面的设计中起着重要作用。通过图表、仪表盘等方式，将变量数据以直观的方式展示给操作员，使其能够快速了解工业过程的运行情况。
  6. **自动化事件控制** ：CMS可以根据不同变量之间的逻辑关系执行自动化事件控制。例如，当某个变量满足特定条件时，自动触发一系列动作或控制策略。
  7. **设备管理与维护** ：通过监控设备的状态变量，CMS可以实现对设备的健康状态进行预测和维护管理。例如，设备运行时间、故障次数等变量可以用于计划维护周期和预防性维护措施。



总的来说，变量管理在CMS中是为了更好地监控、控制和优化工业过程而设计的。它提供了实时数据采集、数据处理、报警处理、自动化事件控制等功能，有助于提高工业生产的效率、安全性和可靠性。

## 通道类型​

### 1）IO通道​

​ 指与外部数据采集程序直接进行数据交换的变量，如下位机数据采集设备（如PLC、仪表等）或其他应用程序（如OPC服务器等）。这种数据交互是双向的、动态的，在CMS运行的过程中，每当IO变量的值改变时，该值就会自动写入下位机或其他应用程序；每当下位机或应用程序中的值改变时，CMS中的变量值也会自动更新。

它们用于表示连接到系统的输入和输出设备的状态、数据或控制信号。以下是一些IO变量的常见应用场景：

  1. **传感器数据采集** ：IO变量用于接收传感器（如温度传感器、压力传感器、流量传感器等）采集到的实时数据。这些数据可以用于监控工业过程中的环境变量和设备状态。
  2. **执行器控制** ：IO变量用于发送控制信号给执行器（如电动阀门、电动马达等），以控制工业过程中的各种操作，如打开/关闭阀门、启动/停止电动设备等。
  3. **报警和故障监测** ：通过与传感器和设备连接，IO变量可以实时监测设备的状态和运行情况。一旦检测到异常或故障，系统可以通过IO变量触发报警和故障通知。
  4. **生产计数和数据记录** ：IO变量用于记录生产过程中的计数信息，如产品数量、产量等。这些数据可以用于生产效率分析和报告。
  5. **安全控制** ：IO变量可用于监测安全设备，如安全传感器、紧急停止按钮等。当安全事件发生时，IO变量可以触发紧急停止或其他安全控制措施。
  6. **逻辑控制** ：IO变量与逻辑控制器（如PLC）结合使用，实现自动化控制和逻辑判断。根据IO变量的状态，控制器可以执行特定的逻辑操作。
  7. **设备状态监测与维护** ：IO变量用于监测设备的状态，例如设备的工作时间、运行状态等。这些数据可用于设备维护和预防性维修。



### 2）内部通道​

#### 内部变量、I/O、逻辑变量：​

它们是由软件系统内部创建和使用的变量，通常不直接与外部传感器或执行器相连接，而是用于内部逻辑控制、数据处理和计算等目的。以下是内部变量的一些常见应用场景：

  1. **逻辑控制** ：内部变量用于在CMS中实现逻辑控制功能。通过设定内部变量的取值，可以触发或停止特定的操作或控制策略，实现自动化的控制逻辑。
  2. **计算和数据处理** ：内部变量可用于进行各种计算和数据处理操作。例如，对输入数据进行求和、平均值计算、滤波处理等，从而得到更有用的数据用于监测和控制。
  3. **状态管理** ：内部变量可以用于记录和管理系统的状态信息。例如，记录系统当前运行状态、存储故障代码等，便于故障排查和状态监测。
  4. **定时器和计数器** ：内部变量常用于实现定时器和计数器功能。它们可以用于设置延时操作、定时任务或对事件进行计数。
  5. **状态转换和状态机** ：内部变量可以用于实现状态转换和状态机逻辑。通过监控和更新内部变量的状态，系统可以实现不同状态之间的转换和相应的控制动作。
  6. **临时存储** ：内部变量可用于临时存储和传递数据。在执行复杂的计算或逻辑运算时，内部变量可以暂时保存中间结果，以供后续步骤使用。
  7. **数据映射与格式转换** ：有时候，不同部分的软件系统需要使用不同的数据格式，内部变量可以用于数据映射和格式转换，将数据从一种格式转换为另一种格式。
  8. **事件触发和通知** ：内部变量用于监测特定事件的发生并触发相应的通知或动作。例如，当特定条件满足时，设置内部变量来触发报警或发送通知。



总的来说，内部变量在CMS中扮演着重要角色，用于实现各种逻辑控制、数据处理和状态管理等功能。它们提供了灵活性和便捷性，能够增强系统的自动化和智能化能力。

#### 系统变量：​

系统变量是由CMS系统预定义或自动生成的特殊变量，用于记录和表示系统的状态、性能和其他重要信息。这些变量的值由系统自动更新和维护，而不是由用户手动输入或控制。以下是系统变量的一些常见应用场景：

  1. **时间和日期** ：系统变量可以用于记录当前的时间和日期。这在CMS系统中非常有用，例如在事件记录、操作日志和报警记录中，可以标记每个事件的发生时间。
  2. **班次信息** ：系统变量可用于记录系统中班次的名称、当前班次的日期，以帮助操作员快速识别当前班次。
  3. **系统配置信息** ：系统变量可以存储系统的配置信息和参数设置。这些参数可能包括通信设置、采样周期、控制参数等。
  4. **用户权限和登录状态** ：系统变量可用于表示用户的权限级别和登录状态。这对于实施访问控制和安全管理非常重要。
  5. **通信状态** ：对于涉及到网络通信的设备，系统变量可以用于记录设备状态，如设备连接状态、通信错误计数等。
  6. **事件触发和自动化控制** ：系统变量在自动化控制中可以作为触发条件，用于实现特定事件的自动触发和控制操作。



系统变量在CMS系统中起到了监测、记录和控制系统的重要作用。它们提供了对系统状态、性能和配置的实时访问，帮助用户更好地了解和管理工业过程。 

提供预设的变量，在系统中已经定义好，用户可以直接使用，如当前系统时间、当前设备通讯状态等。

## 界面介绍及操作​

1）变量通道：点击顶部对应通道类型页签，在页签下查看对应类型的通道

变量通道区点击操作按钮，可新增、编辑通道、分组，删除通道、分组，支持搜索通道、分组

2）操作栏

  * 筛选：支持按照数据类型筛选，或输入变量名进行搜索

  * 添加：点击添加按钮，列表末尾新增一条变量记录，直接操作变量记录即可进行变量的配置（各类型的变量配置略有差别，请参考下面章节的介绍）

  * 批量创建变量：选中单个变量点击批量创建变量按钮，输入需要的创建的数量，进行变量的批量创建

  * 删除：选中变量记录，点击删除按钮，即完成变量的删除

  * 变量批量处理：选中多条变量记录，点击变量批量处理按钮，可对变量的名称、地址、属性进行批量修改

  * 变量引用列表：选中单个变量，点击变量引用，查看当前变量被应用的位置

  * 导出：可对整个通道的内容进行导出备份操作

  * 导入：可选择更新导入对已有变量进行更新的操作，或者使用覆盖导入将旧数据全部删除以最近导入的变量为准

  * 保存：变量配置完成后，请手动点击按钮进行保存

  * 重置：若期望清除本次变量的配置，还原至最近一次保存的配置，请点击按钮进行重置

  * 启动调试：点击进入变量调试模式，可读写、查看质量戳、最新变化时间

    * 当前值：实时更新当前变量值，可输入进行下发；

    * 质量戳：反馈读写操作质量，数据质量码如下：

值| 描述| 处理建议  
---|---|---  
0| 读取/下发成功|   
1| 变量名不存在| 只读取存在的变量名  
2| 数据类型不匹配| 数据类型下发要校验匹配  
3| 变量对应的设备断开| 排查设备断开原因  
4| 其它异常|   
    * 最新变化时间：变量值变化的更新时间；





---

该文档地址来源：https://cms-docs.shengyc.com/cms/tutorial/%E5%8F%98%E9%87%8F%E7%AE%A1%E7%90%86/%E5%8F%98%E9%87%8F%E6%A6%82%E8%BF%B0