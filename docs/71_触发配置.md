# 触发配置

## 1.概述​

### 1.1触发概念​

数据表的不同类型代表了不同的【执行动作】，如变量归档类型，每条记录为每次归档动作的结果，数据聚合类型，每条记录为每次聚合动作的结果。动作执行的时机，被称为【触发条件】。设定【触发条件】之后，数据服务会根据数据变化，自动执行对应类型的【执行动作】。

### 1.2触发使用​

#### 通用说明​

触发条件可配置多项，配置多项时，任意一项触发条件满足时，都会执行一次动作。

以下两种触发方式，对归档、聚合类型的数据表都可用：

  * 变量触发：通过配置变量表达式的方式，判断表达式的结果，可以实现任意场景下，复杂条件下，不同业务规则触发的数据记录；

例：完工信号触发时，记录每个产品在加工过程中的对应加工参数；

    * 触发动作：配置变量表达式，按表达式结果触发，表达式的结果为真（TRUE）或假（FALSE）；

    * 结果类型：代表了表达式结果变化的方向；

      * 变真：单向动作，由假变真时，触发一次；

      * 变假：单向动作，由真变假时，触发一次；

      * 真假变化：双向动作，由假变真或由真变假时，触发一次；

> 注：表达式结果保持不变时，未配置重复频率，不会再次触发；

    * 重复频率：可设置表达式结果触发之后，在结果保持不变的情况下，定时触发多次；

> 注：真假变化的类型，不支持该设置；

  * 定时触发：通过配置起始时间和重复频率的方式，控制在对应的时间节点进行触发，一般满足常规场景下，时间序列数据的采集；可配置多个不同的触发时间和重复频率的组合，满足复杂时间节点触发的数据记录；

    * 触发时间：为起始时间，结合重复频率使用，；
    * 重复频率：定时触发的频率，按需使用；
    * 同时满足条件：配置变量表达式，定时触发时，要表达式结果为真，才会触发记录；



#### 归档触发​

  * 字段触发：默认监听数据字段，当字段值变化时触发，一般满足当前数据表数据层面的变化更新记录；

    * 同时满足条件：配置变量表达式，字段触发时，要表达式结果为真，才会触发记录；
  * 报警触发：复用报警管理模块的报警规则设置，一般满足故障报警发生的情况下，持续记录一段时间的关键参数的变化趋势，形成系统的故障快照；

    * 报警点：可选择多项报警点，任意报警点满足条件时触发；

> 注：需要提前在报警管理模块，进行报警规则的设置；

    * 重复频率：可设置任意报警点触发之后，在报警未恢复正常的情况下，定时触发多次；

  * 变化触发：可选择多项变量点，任意变量点数据变化时触发，一般满足关键状态切换时的系统数据记录，如设备运行状态切换、班次切换；

> 注：该触发方式用于监听变量不同枚举状态的切换，若是数值型变量，可用变量触发类型，配置变量表达式；




#### 聚合触发​

  * 实时更新：关联的原始表更新时，聚合表自动更新；

> 注：一般需要实时更新的关键数据表，才会启用该配置，建议在系统资源充足的情况下，如每日0点，统一对所有聚合表进行更新；
> 
> 若原始表数据更新较频繁或较多聚合表配置该项，将会占用更多的系统资源，请提前考虑，在推荐配置的基础上提高内存；




### 2.注意事项​

  1. 数据表秒级处理能力，在推荐配置下，可满足5000列数据的同时归档，并不影响其他服务使用，若需要满足更大数据量的归档场景，请及时升级对应的现场部署硬件配置，着重升级内存；




---

该文档地址来源：https://cms-docs.shengyc.com/cms/tutorial/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/%E8%A7%A6%E5%8F%91%E9%85%8D%E7%BD%AE