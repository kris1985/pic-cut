# 展示报表

## 1.应用场景​

在实际生产过程中，每天都会产生大量的生产数据，其中部分重要数据需要记录、归档和做决策分析支持。部分数据需要通过EXCEL制作自定义表单，打印表格，手动抄录，如：设备点巡检、产品首检、物料入库统计表等。

展示报表可将以上场景录入的数据表，通过简单的拖拉拽和配置方式制作出中国式复杂报表，轻松实现报表的多样化展示、交互分析和打印输出。同时还支持主子表的关联展示，如一个点检记录表作为主表，组合多个点检明细表，联合展示。展示报表还可以结合集成互联功能，对关联的数据集进行数据的填报插入，结合筛选器选中对应记录，进行数据修改等。

## 2.功能介绍​

​ 图1：开发版配置图

​ 图2：运行版展示图

### 2.1数据配置​

1）数据集：展示报表当前所选的数据表

  * 聚合数据：支持选择数据管理的归档、加工聚合处理的数据表，同时支持两个以上的数据表配置，在样式上，主表以自由格式循环展示，子表根据与主表配置的字段关联关系，根据字段列向下或向右扩展展示

  * 历史数据：支持使用历史库的时序数据，可以查看变量过去时间范围内的历史数据

数据查询：关联超级控制器，报表根据筛选器所设置的条件进行查询

    * 点击

筛选条件控制器，双击报表左上方的筛选器，设置筛选条件，或下拉关联页面中已有筛选器(筛选器使用参考[这里](/cms/tutorial/页面管理/搭建分析看板/添加控制组件/筛选器))
    * 在开发环境设置的筛选条件，为工程运行时图表查询的初始条件，若运行时无须修改历史查询条件，可将筛选器隐藏
    * 若需设置定时自动更新，如实时近5分钟，在配置条件后，勾选自动刷新数据功能，频率可自定义 



2）字段关联：

当展示报表需要配置两个以上聚合数据集时，可通过字段关联配置两个数据集的字段关联绑定关系，主表字段与子表字段之间是一对多的关系。其中字段配置除了直接选用字段外，还可通过计算公式配置将字段进行公式处理后再来匹配关联

3）最大数据量

  * 运行模式：设置运行版主数据集的最大展示数量
  * 翻页设置：运行版的组件每页加载主数据集的最大数据量



### 2.2报表配置​

  * 展示设置：设置不同数据集的字段扩展方式

    * 表格循环：当主数据集配置表格循环时，字段数据经过筛选后的每条数据会根据在开发版配置的表格样式，在运行版以表格复制方式进行循环往下展示

​ 开发版-表格循环

​ 运行版-表格循环

    * 不扩展：当数据集字段配置不扩展时，字段数据经过关联查询和筛选后的所有值，会填充到配置单元格

​ 开发版-不扩展

​ 运行版-不扩展

    * 向下扩展：当数据集字段配置向下扩展时，字段数据经过关联查询和筛选后的所有值，会以单元格扩展方式向下填充

​ 开发版-向下扩展

​ 运行版-向下扩展

    * 向右扩展：当数据集字段配置向右扩展时，字段数据经过关联查询和筛选后的所有值，会以单元格扩展方式向右填充

​ 开发版-向右扩展 运行版-向右扩展

  * 区域位移

    * 向下平移：报表向下循环时，高度不受组件配置高度限制，报表下方区域组件向下平移，画布也向下扩展
    * 不平移：报表向下循环时，高度受组件配置高度限制，报表下方区域组件不平移，画布也不扩展



### 2.3单元格配置​

  * 单元格元素

    * 名称：当前选中单元格的名称

    * 插入元素：

      * 文本：支持选中单元格输入自定义文本，也可选择插入元素为文本，在内容栏上自定义文本内容
      * 数据集字段：支持拖拽数据集的字段到单元格，完成单元格与字段的关联
      * 斜线：支持单元格元素选择斜线，然后输入内容，以“|”作为分隔符做区分
      * 实时变量：支持单元格元素选择实时变量，内容处关联实时变量，单元格在开发版显示变量名，在运行版显示当前变量的实时值
    * 格式：用户可以通过样式来对数字、日期等实际单元格的值定义显示格式，不会改变实际值

      * 文本：将单元格数据以文本/字符串的数据格式进行显示
      * 数值：将单元格数据以数值型的数据格式进行显示，可选择显示小数后多少位
      * 日期：将单元格数据以日期型的数据格式进行显示，支持选择不同的日期格式
      * 时间：将单元格数据以时间型的数据格式进行显示，支持选择不同的时间格式
      * 百分比：将单元格数据以时间型的百分比格式进行显示，百分比中，可选择显示小数后多少位
    * 条件样式：定义单元格内容，不同条件的字体和单元格填充样式

      * 条件组支持配置一个或多个条件样式

      * 条件判断遵从单元格的值，满足什么条件，展示什么样式，自上而下进行匹配，匹配上条件后，不会再往下匹配




### 2.4表格组件配置​

  * 整体表格配置

    * 报表工具栏

      * 字体：可设置整个表格的字体样式，大小、颜色和位置设置等
      * 单元格：可设置单元格填充色和边框，进行单元格合并与拆分
      * 行列：可通过输入行列数，定义整体表格的行列数量，也可选中对应行点击行列按钮，在上方或下方插入，选中对应列，在左侧或右侧插入
      * 高宽：可通过输入高宽数值，定义整体表格的行高列宽大小，也可在对应行列，进行手动拖动来设置行高列宽
    * 报表标题

      * 可在标题配置栏中，定义报表标题
    * 表格

      * 点击左上角的方形按钮，可选中整个表格
      * 可通过从excel表中copy内容，然后粘贴到报表中，进行快速配置

  * 单元格配置

    * 报表工具栏

      * 选中单元格，报表工具栏会从整体表格工具栏切换到单元格工具栏
    * 单元格

      * 支持对单元格自定义输入内容或关联实时变量
      * 也可将数据集字段，拖拽到单元格中完成字段与单元格的关联
      * 支持对多个单元格操作合并与合并单元的拆分





---

该文档地址来源：https://cms-docs.shengyc.com/cms/tutorial/%E9%A1%B5%E9%9D%A2%E7%AE%A1%E7%90%86/%E5%88%B6%E4%BD%9C%E5%A4%8D%E6%9D%82%E6%8A%A5%E8%A1%A8/%E5%B1%95%E7%A4%BA%E6%8A%A5%E8%A1%A8