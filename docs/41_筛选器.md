# 筛选器

## 应用场景​

筛选器的应用场景更广更灵活，相当于超级控制器，支持选择**查询关键字段+判断条件+值** 一体的自由控制，直接可添加多个筛选条件。普通控制组件在配置工程时已限定查询关键字段及配置，而超级控制器将开放，在工程运行时亦可更新，更自主可控。

## 操作使用​

1）前提：图表关联

首先需将图表关联筛选器，完成控制关系的绑定。绑定后，图表查询时将以筛选器所设置的条件进行。

2）使用：条件设置

点击筛选按钮，弹出条件面板，再次点击收起面板；

弹出条件面板后，点击

，新增1行条件，下面将说明条件配置使用；

  * 查询关键字段：下拉选择字段，为所控制图表其源数据字段；

  * 查询判断条件：下拉选择，支持=、!=、>、<、>=、<=、包含、不包含、为空、不为空；

  * 查询条件值：

    * 文本&数值：支持输入及下拉两种设置值方式，点击条件右侧的

进行切换。

    * 时间值：

      * 支持绝对时间，支持年、年月、年月日（日期）、年月日时分秒（日期时间）多种粒度选择，点击下拉选择对应粒度，点击时间面板即可选择

（若筛选一段时间，可设置>=开始时间，<=结束时间）

      * 支持相对时间，从当前时刻往前推或往后推，如近30分钟/后7天，点击下拉选择相对，输入相对时间及单位；

      * 支持快捷时间，如本小时、今天、昨天、本周、上周、本月、上月、本季度、本年度，点击下拉直接选择对应的快捷项；




点击确认，即可触发图表查询

## 组件配置​

外观文本：设置筛选器外观文本样式

权限控制：勾选，该组件的控制操作需验证当前登录用户是否有权限进行操作。详见[运行模块-权限管理](/cms/tutorial/页面管理/使用运行模块/权限管理)

## 特别说明​

tip1：在开发环境设置的筛选条件，为工程运行时图表查询的初始条件，若运行时无须修改历史查询条件，可将筛选器隐藏

tip2：点击确认手动触发图表的查询，若需设置定时自动更新，如实时近5分钟，在配置条件后，对应勾选自动刷新数据功能，频率可自定义

tip3：支持通过事件脚本获取和设置筛选条件，满足

  * 获取筛选条件：获取控件值至变量，如将当前筛选器的筛选条件"字段A >= 100 && 字段B = 日期 '2023-06-05' "输出至变量



  * 设置筛选条件：设置控件值，如设置筛选器的筛选条件为"字段A >= 100 && 字段B = 日期 '2023-06-05' "，设置后将自动触发查询更新


    
    
    # 筛选条件格式说明  
    1条筛选条件的组装规则为，字段+比较符+标识（一般日期字段才有标识，非必填）+值  
    注：①+替换为空格号，即4个元素需有空格号隔开  
       ②筛选条件为字符串，需用双引号包含  
      
    - 示例:  
      - "温度 > 100 && ph值 <= 5"  
      - "温度 大于 100 且 成分 包含 '铁' 且 故障 为空"  
      - "生产日期 等于 日期 '2023-06-05'"  
      - "生产日期 等于 近 7 天"  
      - "生产日期 等于 去年"  
      
      
    - 格式: "字段 比较符 值"  
    - 连接: and, &&, 且, 并且  
    - 多条件: "条件 连接 条件"  
    - 比较符:  
      - =, ==, 等于  
      - !=, <>, 不等于  
      - >, 大于  
      - < ,小于  
      - >=, 大于等于  
      - <=, 小于等于  
      - 包含  
      - 不包含  
      - 为空  
      - 不为空  
    - 值：  
      - 数字: 123  
      - 文本: 'abc'  
      - 日期:  
        - 绝对日期：标识 值  
          - 标识：日期, 时间, 日期时间  
          - 值: yyyy, yyyy-MM, yyyy-MM-dd, yyyy-MM-dd hh:mm:ss  
        - 相对日期：  
          - 近 N 单位  
            - 单位: 天, 时, 分, 秒  
          - 后 N 单位  
            - 单位: 同上  
          - 今天  
          - 昨天  
          - 本周  
          - 上周  
          - 本月  
          - 上月  
          - 本季度  
          - 上季度  
          - 今年  
          - 去年  
    

若仍对筛选器-设置筛选条件的格式模糊，您可配置一个基础输入框，当筛选器输入变化（变化筛选条件）时，设置基础输入框控件值为当前筛选器的控件值（筛选条件），此后在筛选器上设定您期望设置的条件，基础输入框显示所设定的筛选条件，可复制该条件作为设置筛选条件的值，无需自己按格式拼凑。

## 应用示例​

### 场景说明​

通常生产过程中存在异常情况，期望快速查看异常时间段参数变化曲线。该互动场景可通过筛选器动态传参灵活配置，如下以通过点击报警记录查看该时段内该设备压力变化曲线为例。

### 演示效果​

### 配置过程​

#### 1）添加趋势曲线​

在”趋势配置“中添加趋势曲线：压力随时间变化情况，并为其添加筛选器

#### 2）创建表格​

创建表格，关联数据表：报警管理-历史表，选择显示维度：报警名称、报警时间、恢复时间

#### 3）配置事件动作​

为表格配置事件动作，事件类型为选中时，目标为趋势曲线关联的筛选器，动作为设置控件值

表达式配置如下：
    
    
    "记录时间 >= 日期时间 "+event.row.cells[1].value+" 且 记录时间 <= 日期时间 "+event.row.cells[2].value   
    

  * 表达式为字符串，为字符拼接形式

    * "记录时间 >= 日期时间 "为字段+比较符+标识形式

    * event.row.cells[1].value与event.row.cells[2].value为值，分别代表所选行第二列”报警时间“与第三列”恢复时间“

    * " 且 记录时间 <= 日期时间 "为连接符+ 字段+比较符+标识形式

注：①连接符、字段、比较符、标识、值每个元素之间都需要用空格号隔开

​ ②非引用参数的元素需要用双引号包含





---

该文档地址来源：https://cms-docs.shengyc.com/cms/tutorial/%E9%A1%B5%E9%9D%A2%E7%AE%A1%E7%90%86/%E6%90%AD%E5%BB%BA%E5%88%86%E6%9E%90%E7%9C%8B%E6%9D%BF/%E6%B7%BB%E5%8A%A0%E6%8E%A7%E5%88%B6%E7%BB%84%E4%BB%B6/%E7%AD%9B%E9%80%89%E5%99%A8